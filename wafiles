#!/bin/bash
# This script uses curl to push files to our server. 
# login information is in .netrc
# If it fails silently, make sure that .netrc has the proper machine name, the same as is used in the curl command.
#

createPutFile()
{
    [[ -z "$thisDir" ]] && { echo "No target directory. Exiting..." ; exit 1; }
    thisPutFile=cadaver.put
    echo "open https://assumptioncollegewise.wildapricot.org/resources" > $thisPutFile
    printf "%s\n" "cd $thisDir" >> $thisPutFile
    for f in $thisFile; do
	thisFile=$(basename $f)
	printf "%s\n" "put $f "  >> $thisPutFile
        done
    printf "%s\n" "exit" >> $thisPutFile
}

doit()
{
#    cadaver --rcfile=cadaver.put
    #    printf '%d\n' $?
    curl -v --anyauth --netrc-file ~/.netrc  'https://assumptionwise.org/resources/'$thisDir/ -T $thisFile

    #    echo "We would do this here"
}
getHelp()
{
    echo "-b  Blog and Bulletin indexes go to Documents/reference/"
    echo "-l  Files containing Zoom links go to Links" 
    echo "-w  Others go to Documents/website"
    echo "-c  Put files in Documents/class.assistants"
    echo "-t  tmp directory for files" 
}
while getopts "b:l:t:w:c:h" opt; do
    case ${opt} in
	b) # Blogs
	    thisFile=$OPTARG
	    thisDir="Documents/reference"
	    ;;
	c) # Class Assistants
	    thisFile=$OPTARG
	    thisDir="Documents/class.assistants"
	    ;;
	l) # Links
	    thisFile=$OPTARG
	    thisDir="Links"
	    echo "Putting $thisFile in $thisDir"
	    ;;
	t) # tools directory
	    thisFile=$OPTARG
	    thisDir="tools"
	    ;;
	w) # Other stuff
	    thisFile=$OPTARG
	    thisDir="Documents/website"
	    ;;
	h) # Print help and exit
	    getHelp
	    ;;
	?)
	getHelp
	;;

    esac
    done

#createPutFile
doit
